<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Marketing System - Network Access</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            color: #333;
        }
        
        .logo {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #667eea;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 2rem;
        }
        
        .ip-info {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border-left: 4px solid #667eea;
        }
        
        .ip-address {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 0.5rem;
        }
        
        .qr-container {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
            display: inline-block;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .qr-code {
            width: 200px;
            height: 200px;
            border: 2px solid #eee;
        }
        
        .access-links {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin: 2rem 0;
        }
        
        .link-card {
            background: #667eea;
            color: white;
            padding: 1rem;
            border-radius: 10px;
            text-decoration: none;
            transition: transform 0.3s ease;
        }
        
        .link-card:hover {
            transform: translateY(-2px);
            background: #5a6fd8;
        }
        
        .link-title {
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        .link-url {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .instructions {
            background: #e3f2fd;
            border-radius: 10px;
            padding: 1.5rem;
            margin-top: 2rem;
            text-align: left;
        }
        
        .instructions h3 {
            color: #1976d2;
            margin-bottom: 1rem;
        }
        
        .instructions ol {
            margin-left: 1rem;
        }
        
        .instructions li {
            margin-bottom: 0.5rem;
        }
        
        .status {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            margin-top: 1rem;
        }
        
        .status.online {
            background: #4caf50;
            color: white;
        }
        
        .status.offline {
            background: #f44336;
            color: white;
        }
        
        .footer {
            margin-top: 2rem;
            font-size: 0.9rem;
            color: #666;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .logo {
                font-size: 2rem;
            }
            
            .qr-code {
                width: 150px;
                height: 150px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">ðŸ“± SIVM Content Marketing</div>
        <div class="subtitle">Network Access Dashboard</div>
        
        <div class="ip-info">
            <div class="ip-address" id="ipAddress">Loading...</div>
            <div>Server IP Address</div>
            <div class="status" id="serverStatus">Checking...</div>
        </div>
        
        <div class="qr-container">
            <div id="qrcode" class="qr-code"></div>
        </div>
        
        <div class="access-links" id="accessLinks">
            <!-- Links will be generated by JavaScript -->
        </div>
        
        <div class="instructions">
            <h3>ðŸ“‹ Cara Akses dari Perangkat Lain:</h3>
            <ol>
                <li>Pastikan perangkat Anda terhubung ke WiFi yang sama</li>
                <li>Scan QR Code di atas dengan kamera atau QR scanner</li>
                <li>Atau ketik manual alamat IP ke browser</li>
                <li>Pilih menu yang ingin diakses</li>
            </ol>
        </div>
        
        <div class="footer">
            Content Marketing Management System<br>
            <small>Built with Laravel & Vue.js</small>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script>
        // Get IP address and generate access information
        async function initializeNetworkAccess() {
            try {
                // Try to get IP from a simple API
                const response = await fetch('/api/network-info').catch(() => null);
                let ipAddress = '172.16.1.77'; // Default fallback
                
                if (response && response.ok) {
                    const data = await response.json();
                    ipAddress = data.ip || ipAddress;
                }
                
                // Update IP display
                document.getElementById('ipAddress').textContent = ipAddress;
                
                // Generate QR code
                const mainUrl = `http://${ipAddress}:8000`;
                QRCode.toCanvas(document.getElementById('qrcode'), mainUrl, {
                    width: 200,
                    height: 200,
                    colorDark: '#667eea',
                    colorLight: '#ffffff'
                });
                
                // Generate access links
                const links = [
                    {
                        title: 'ðŸ  Dashboard Utama',
                        url: `http://${ipAddress}:8000`,
                        description: 'Halaman utama aplikasi'
                    },
                    {
                        title: 'ðŸ“ Content Marketing',
                        url: `http://${ipAddress}:8000/konten-marketing`,
                        description: 'Dashboard manajemen konten'
                    },
                    {
                        title: 'ðŸ“… Content Calendar',
                        url: `http://${ipAddress}:8000/content-calendar`,
                        description: 'Kalender jadwal konten'
                    },
                    {
                        title: 'ðŸ”— Social Media',
                        url: `http://${ipAddress}:8000/social-integration`,
                        description: 'Integrasi Instagram & TikTok'
                    }
                ];
                
                const linksContainer = document.getElementById('accessLinks');
                linksContainer.innerHTML = links.map(link => `
                    <a href="${link.url}" class="link-card" target="_blank">
                        <div class="link-title">${link.title}</div>
                        <div class="link-url">${link.url}</div>
                        <div style="font-size: 0.8rem; opacity: 0.8; margin-top: 0.25rem;">${link.description}</div>
                    </a>
                `).join('');
                
                // Check server status
                checkServerStatus(ipAddress);
                
            } catch (error) {
                console.error('Error initializing network access:', error);
                document.getElementById('ipAddress').textContent = '172.16.1.77 (Default)';
                document.getElementById('serverStatus').textContent = 'Unknown';
                document.getElementById('serverStatus').className = 'status offline';
            }
        }
        
        async function checkServerStatus(ipAddress) {
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 5000);
                
                const response = await fetch(`http://${ipAddress}:8000`, {
                    method: 'HEAD',
                    signal: controller.signal
                });
                
                clearTimeout(timeoutId);
                
                const statusElement = document.getElementById('serverStatus');
                if (response.ok) {
                    statusElement.textContent = 'ðŸŸ¢ Online';
                    statusElement.className = 'status online';
                } else {
                    statusElement.textContent = 'ðŸ”´ Offline';
                    statusElement.className = 'status offline';
                }
            } catch (error) {
                const statusElement = document.getElementById('serverStatus');
                statusElement.textContent = 'ðŸ”´ Offline';
                statusElement.className = 'status offline';
            }
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initializeNetworkAccess);
        
        // Refresh status every 30 seconds
        setInterval(() => {
            const ipAddress = document.getElementById('ipAddress').textContent;
            if (ipAddress && ipAddress !== 'Loading...') {
                checkServerStatus(ipAddress.split(' ')[0]); // Get IP only, remove "(Default)" if present
            }
        }, 30000);
    </script>
</body>
</html>